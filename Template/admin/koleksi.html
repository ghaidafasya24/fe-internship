<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tambah Koleksi - Museum Sri Baduga</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body class="bg-gray-100 font-sans">

  <div class="flex h-screen">
    <!-- Sidebar -->
    <aside class="w-64 bg-white shadow-md flex flex-col">
      <div class="p-5 text-center border-b">
        <h1 class="text-lg font-bold text-gray-800">Museum Sri Baduga</h1>
        <p class="text-sm text-gray-500">Admin Dashboard</p>
      </div>
      <nav class="flex-1 p-4 space-y-2">
        <a href="../dasboard.html" class="block py-2.5 px-4 rounded hover:bg-gray-200 font-medium text-gray-700">Dashboard</a>
        <a href="koleksi.html" class="block py-2.5 px-4 bg-gray-200 font-semibold text-gray-900">Koleksi</a>
        <a href="kategori.html" class="block py-2.5 px-4 rounded hover:bg-gray-200 font-medium text-gray-700">Kategori</a>
        <a href="#" class="block py-2.5 px-4 rounded hover:bg-gray-200 font-medium text-gray-700">Laporan</a>
        <a id="logoutButton" href="#" class="block py-2.5 px-4 rounded hover:bg-red-200 font-medium text-red-700">Logout</a>
      </nav>
    </aside>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col">
      <header class="bg-white shadow-sm p-4 flex justify-between items-center">
        <h2 class="text-xl font-semibold text-gray-800">Manajemen Koleksi Museum</h2>
      </header>

      <main class="p-6 overflow-y-auto flex-1">
        <div class="bg-white rounded-xl shadow p-6">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold text-gray-800">Daftar Koleksi</h3>
            <button id="openModal" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
              + Tambah Koleksi
            </button>
          </div>

          <table class="min-w-full border border-gray-200 rounded-lg overflow-hidden">
            <thead class="bg-gray-100">
              <tr>
                <th class="px-4 py-2 border-b">No</th>
                <th class="px-4 py-2 border-b">Nama Koleksi</th>
                <th class="px-4 py-2 border-b">Kategori</th>
                <th class="px-4 py-2 border-b">No Registrasi</th>
                <th class="px-4 py-2 border-b">No Inventaris</th>
                <th class="px-4 py-2 border-b">Bahan</th>
                <th class="px-4 py-2 border-b">Ukuran</th>
                <th class="px-4 py-2 border-b">Kondisi</th>
                <th class="px-4 py-2 border-b">Tahun Perolehan</th>
                <th class="px-4 py-2 border-b">Asal</th>
                <th class="px-4 py-2 border-b">Penyimpanan</th>
                <th class="px-4 py-2 border-b">Deskripsi</th>
                <th class="px-4 py-2 border-b">Gambar</th>
                <th class="px-4 py-2 border-b text-center">Aksi</th>
              </tr>
            </thead>
            <tbody id="tableKoleksi"></tbody>
          </table>

        </div>
      </main>
    </div>
  </div>

  <!-- Modal -->
  <div id="modal" class="fixed inset-0 hidden bg-black bg-opacity-50 flex justify-center items-center p-4 z-50">
    <div class="bg-white rounded-xl shadow-lg p-6 w-full max-w-4xl max-h-[95vh] overflow-y-auto">
      <h3 id="modalTitle" class="text-lg font-semibold mb-4">Tambah Koleksi</h3>
      <form id="addCollectionForm" class="space-y-4">

        <!-- Baris 1: Nama & Kategori -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Nama Koleksi *</label>
            <input id="nama_benda" name="nama_benda" placeholder="Nama Koleksi" class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent" required />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Kategori *</label>
            <select id="kategori" name="kategori_id" class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent" required></select>
          </div>
        </div>

        <!-- Baris 2: No Registrasi & No Inventaris -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">No Registrasi</label>
            <input id="no_reg" name="no_reg" placeholder="Contoh: REG001" class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">No Inventaris</label>
            <input id="no_inv" name="no_inv" placeholder="Contoh: INV001" class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
          </div>
        </div>

        <!-- Baris 3: Bahan -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Bahan</label>
          <input id="bahan" name="bahan" placeholder="Contoh: Kayu, Besi, Keramik, dll" class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
        </div>

        <!-- Baris 4: Ukuran dengan Unit Dropdown -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ukuran</label>
          <div class="grid grid-cols-3 gap-2 mb-2">
            <!-- Ukuran Unit Dropdown -->
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Unit Ukuran</label>
              <select id="satuan_ukuran" name="satuan_ukuran" class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <option value="">Pilih Satuan</option>
                <option value="mm">Milimeter (mm)</option>
                <option value="cm">Sentimeter (cm)</option>
                <option value="m">Meter (m)</option>
                <option value="inch">Inchi (inch)</option>
              </select>
            </div>
          </div>
          <div id="ukuran_fields" class="grid grid-cols-3 gap-2">
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Panjang</label>
              <input id="panjang_keseluruhan" type="number" step="0.01" placeholder="0" class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Lebar</label>
              <input id="lebar" type="number" step="0.01" placeholder="0" class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Tebal</label>
              <input id="tebal" type="number" step="0.01" placeholder="0" class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Tinggi</label>
              <input id="tinggi" type="number" step="0.01" placeholder="0" class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Diameter</label>
              <input id="diameter" type="number" step="0.01" placeholder="0" class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Berat (kg)</label>
              <input id="berat" type="number" step="0.01" placeholder="0" class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
          </div>
        </div>

        <input type="hidden" id="json" name="ukuran" value="" />

        <!-- Baris 5: Kondisi & Tanggal Perolehan -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Kondisi</label>
            <select id="kondisi" name="kondisi" class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent">
              <option value="">Pilih Kondisi</option>
              <option value="Sangat Baik">Sangat Baik</option>
              <option value="Baik">Baik</option>
              <option value="Cukup Baik">Cukup Baik</option>
              <option value="Kurang Baik">Kurang Baik</option>
              <option value="Rusak">Rusak</option>
              <option value="Rusak Berat">Rusak Berat</option>
              <option value="Rusak Berat">Ganti Rugi</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Tanggal Perolehan</label>
            <input id="tahun_perolehan" name="tanggal_perolehan" type="date" class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent"/>
          </div>
        </div>

        <!-- Baris 6: Asal Perolehan -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Asal Perolehan</label>
          <input id="asal_perolehan" name="asal_koleksi" placeholder="Contoh: Donasi, Pembelian, Warisan, dll" class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent"/>
        </div>

        <!-- Baris 7: Penyimpanan (Gudang & Rak) -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Gudang</label>
            <select id="gudang" name="gudang" class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent">
              <option value="">Pilih Gudang</option>
              <option value="Gudang A">Gudang A</option>
              <option value="Gudang B">Gudang B</option>
              <option value="Gudang C">Gudang C</option>

            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Rak/Lemari</label>
            <select id="rak" name="rak" class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent">
              <option value="">Pilih Rak</option>
              <option value="Rak 1">Rak 1</option>
              <option value="Rak 2">Rak 2</option>
              <option value="Rak 3">Rak 3</option>
              <option value="Rak 4">Rak 4</option>
            </select>
          </div>
        </div>

        <!-- Baris 8: Tempat Penyimpanan Gabungan -->
        <div id="tempat_penyimpanan_display" class="bg-gray-50 border border-gray-200 rounded px-3 py-2">
          <p class="text-sm text-gray-600">Lokasi: <span id="lokasi_display" class="font-medium text-gray-800">-</span></p>
        </div>
        <input type="hidden" id="tempat_penyimpanan" name="tempat_penyimpanan" value="" />

        <!-- Baris 9: Deskripsi -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Deskripsi</label>
          <textarea id="deskripsi" name="ket" placeholder="Catatan dan deskripsi tambahan tentang koleksi..." class="border border-gray-300 rounded px-3 py-2 w-full h-24 focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"></textarea>
        </div>

        <!-- Baris 10: Gambar -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Gambar/Foto</label>
          <input type="file" id="foto" name="foto" accept="image/*" class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
        </div>

        <div id="imagePreview" class="hidden mt-2">
          <p class="text-sm text-gray-600 mb-2">Preview:</p>
          <img id="preview" class="h-48 w-48 object-cover rounded-lg border">
        </div>

        <div class="flex justify-end space-x-2 mt-6 pt-4 border-t">
          <button type="button" id="closeModal" class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400 transition">Batal</button>
          <button id="btnSimpanKoleksi" type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">Simpan</button>
        </div>

      </form>
    </div>
  </div>

  <!-- SCRIPT MODAL -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const modal = document.getElementById("modal");
      const openModal = document.getElementById("openModal");
      const closeModal = document.getElementById("closeModal");
      const gudangSelect = document.getElementById("gudang");
      const rakSelect = document.getElementById("rak");
      const lokasiDisplay = document.getElementById("lokasi_display");
      const tempatPenyimpananInput = document.getElementById("tempat_penyimpanan");

      // Update lokasi display ketika gudang atau rak berubah
      function updateLokasiDisplay() {
        const gudang = gudangSelect.value || "-";
        const rak = rakSelect.value || "-";
        lokasiDisplay.textContent = `${gudang} / ${rak}`;
        tempatPenyimpananInput.value = `${gudang} / ${rak}`;
      }

      gudangSelect.addEventListener("change", updateLokasiDisplay);
      rakSelect.addEventListener("change", updateLokasiDisplay);

      openModal.addEventListener("click", () => {
        document.getElementById("addCollectionForm").reset();
        document.getElementById("json").value = "";
        // Reset ukuran subfields
        document.getElementById("panjang_keseluruhan").value = "";
        document.getElementById("lebar").value = "";
        document.getElementById("tebal").value = "";
        document.getElementById("tinggi").value = "";
        document.getElementById("diameter").value = "";
        document.getElementById("berat").value = "";
        document.getElementById("satuan_ukuran").value = "";
        document.getElementById("kondisi").value = "";
        document.getElementById("gudang").value = "";
        document.getElementById("rak").value = "";
        document.getElementById("imagePreview").classList.add("hidden");
        document.querySelector("#modal h3").textContent = "Tambah Koleksi";
        document.querySelector("#modal button[type='submit']").textContent = "Simpan";
        updateLokasiDisplay(); // Reset lokasi display
        modal.classList.remove("hidden");
      });

      closeModal.addEventListener("click", () => modal.classList.add("hidden"));

      // Image preview
      document.getElementById("foto").addEventListener("change", function(e) {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(event) {
            document.getElementById("preview").src = event.target.result;
            document.getElementById("imagePreview").classList.remove("hidden");
          };
          reader.readAsDataURL(file);
        }
      });
    });
  </script>

  <!-- External JS Modules -->
  <script type="module" src="../../Js/config/url_koleksi.js"></script>
  <script type="module" src="../../Js/controller/add-collection.js"></script>
  <script type="module" src="../../Js/Temp/tabel_koleksi.js"></script>
  <script type="module" src="../../Js/controller/logout.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</body>
</html>

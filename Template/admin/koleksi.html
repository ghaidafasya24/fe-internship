<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tambah Koleksi - Museum Sri Baduga</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body class="bg-gray-100 font-sans overflow-hidden h-screen">


  <div class="flex h-screen">
    <!-- Sidebar -->
    <aside class="w-64 bg-white shadow-md flex flex-col">
      <div class="p-5 text-center border-b">
        <h1 class="text-lg font-bold text-gray-800">Museum Sri Baduga</h1>
        <p class="text-sm text-gray-500">Admin Dashboard</p>
      </div>
      <nav class="flex-1 p-4 space-y-2">
        <a href="../dasboard.html" class="block py-2.5 px-4 rounded hover:bg-gray-200 font-medium text-gray-700">Dashboard</a>
        <a href="koleksi.html" class="block py-2.5 px-4 bg-gray-200 font-semibold text-gray-900">Koleksi</a>
        
        <!-- Filter Gudang Submenu -->
        <div class="gudang-submenu ml-4 mt-2 space-y-1">
          <button class="filter-gudang block w-full text-left py-1 px-2 rounded text-sm hover:bg-blue-100" data-gudang="all">
            Semua Gudang
          </button>
          <!-- Gudang options will be populated by JS -->
        </div>
        
        <a href="kategori.html" class="block py-2.5 px-4 rounded hover:bg-gray-200 font-medium text-gray-700">Kategori</a>
        <a href="#" class="block py-2.5 px-4 rounded hover:bg-gray-200 font-medium text-gray-700">Laporan</a>
        <a id="logoutButton" href="#" class="block py-2.5 px-4 rounded hover:bg-red-200 font-medium text-red-700">Logout</a>
      </nav>
    </aside>

    <!-- Main Content -->
    <div class="flex h-full overflow-hidden">
      <!-- <header class="bg-white shadow-sm p-4 flex justify-between items-center">
        <h2 class="text-xl font-semibold text-gray-800">Manajemen Koleksi Museum</h2>
      </header> -->
      <main class="p-6 flex-1 overflow-hidden">
        <div class="bg-white rounded-xl shadow p-6">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold text-gray-800">Daftar Koleksi</h3>
            <button id="openModal" class="add-koleksi-btn bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
              + Tambah Koleksi
            </button>
          </div>
          <div class="flex items-center gap-3 mb-4">
            <label for="kategoriFilter" class="text-sm text-gray-700">Filter Kategori:</label>
            <select id="kategoriFilter" class="border border-gray-300 rounded px-3 py-2 text-sm min-w-[220px] focus:ring-2 focus:ring-blue-500 focus:border-transparent">
              <option value="all">Semua Kategori</option>
            </select>
            <div class="flex items-center gap-2 ml-auto">
              <label for="searchKoleksi" class="text-sm text-gray-700">Search:</label>
              <input id="searchKoleksi" type="text" placeholder="Cari nama / no reg / no inv" class="border border-gray-300 rounded px-3 py-2 text-sm min-w-[260px] focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
          </div>

          <div class="overflow-x-auto overflow-y-auto max-h-[65vh] border rounded-lg">
            <table class="min-w-[1600px] w-full border-collapse">
              <thead class="bg-gray-100 sticky top-0 z-10">
                <tr>
                  <th class="px-4 py-2 border-b">No</th>
                  <th class="px-4 py-2 border-b">Nama Koleksi</th>
                  <th class="px-4 py-2 border-b">No Registrasi</th>
                  <th class="px-4 py-2 border-b">No Inventaris</th>
                  <th class="px-4 py-2 border-b">Gambar</th>
                  <th class="px-4 py-2 border-b text-center">Aksi</th>
                </tr>
              </thead>
              <tbody id="tableKoleksi"></tbody>
            </table>
          </div>


        </div>
      </main>
    </div>
  </div>

  <!-- Modal -->
  <div id="modal" class="fixed inset-0 hidden bg-black bg-opacity-50 flex justify-center items-center p-4 z-50">
    <div class="bg-white rounded-xl shadow-lg p-6 w-full max-w-4xl max-h-[95vh] overflow-y-auto">
      <h3 id="modalTitle" class="text-lg font-semibold mb-4">Tambah Koleksi</h3>
      <form id="addCollectionForm" class="space-y-4">

        <!-- Baris 1: Nama & Kategori -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Nama Koleksi *</label>
            <input id="nama_benda" name="nama_benda" placeholder="Nama Koleksi"
              class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Kategori *</label>
            <select id="kategori" name="kategori_id"
              class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              required></select>
          </div>
        </div>

        <!-- Baris 2: No Registrasi & No Inventaris -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">No Registrasi</label>
            <input id="no_reg" name="no_reg" required placeholder="Contoh: REG001"
              class="border border-gray-300 rounded px-3 py-2 w-full" />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">No Inventaris</label>
            <input id="no_inv" name="no_inv" placeholder="Contoh: INV001"
              class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
          </div>
        </div>

        <!-- Baris 3: Bahan -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Bahan</label>
          <input id="bahan" name="bahan" placeholder="Contoh: Kayu, Besi, Keramik, dll"
            class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
        </div>

        <!-- Baris 4: Ukuran dengan Unit Dropdown -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Ukuran</label>
          <div class="grid grid-cols-1 gap-2 mb-2">
            <!-- Ukuran Unit Dropdown -->
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Unit Ukuran</label>
              <select id="satuan_ukuran" name="satuan_ukuran"
                class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <option value="">Pilih Satuan</option>
                <option value="mm">Milimeter (mm)</option>
                <option value="cm">Sentimeter (cm)</option>
                <option value="m">Meter (m)</option>
                <option value="inch">Inchi (inch)</option>
              </select>
            </div>
          </div>
          <div id="ukuran_fields" class="grid grid-cols-3 gap-2">
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Panjang</label>
              <input id="panjang_keseluruhan" type="number" step="0.01" placeholder="0"
                class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Lebar</label>
              <input id="lebar" type="number" step="0.01" placeholder="0"
                class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Tebal</label>
              <input id="tebal" type="number" step="0.01" placeholder="0"
                class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Tinggi</label>
              <input id="tinggi" type="number" step="0.01" placeholder="0"
                class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Diameter</label>
              <input id="diameter" type="number" step="0.01" placeholder="0"
                class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
            <div>
              <label class="text-xs text-gray-600 mb-1 block">Berat (kg)</label>
              <input id="berat" type="number" step="0.01" placeholder="0"
                class="border border-gray-300 rounded px-2 py-2 w-full text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
            </div>
          </div>
        </div>

        <input type="hidden" id="json" name="ukuran" value="" />

        <!-- Baris 5: Kondisi & Tanggal Perolehan -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Kondisi</label>
            <select id="kondisi" name="kondisi"
              class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent">
              <option value="">Pilih Kondisi</option>
              <option value="Sangat Baik">Sangat Baik</option>
              <option value="Baik">Baik</option>
              <option value="Cukup Baik">Cukup Baik</option>
              <option value="Kurang Baik">Kurang Baik</option>
              <option value="Rusak">Rusak</option>
              <option value="Rusak Berat">Rusak Berat</option>
              <option value="Rusak Berat">Ganti Rugi</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Tanggal Perolehan</label>
            <input id="tahun_perolehan" name="tanggal_perolehan" type="date"
              class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
          </div>
        </div>

        <!-- Baris 6: Asal Perolehan -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Asal Perolehan</label>
          <input id="asal_perolehan" name="asal_koleksi" placeholder="Contoh: Donasi, Pembelian, Warisan, dll"
            class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
        </div>

        <!-- Baris 7: Penyimpanan (Gudang & Rak) -->
        <div class="grid grid-cols-3 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Gudang</label>
           <select id="gudang" name="gudang_id"></select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Rak/Lemari</label>
            <select id="rak" name="rak_id"></select>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Tahap</label>
            <select id="tahap" name="tahap_id"></select>
          </div>


        </div>

        <!-- Baris 8: Tempat Penyimpanan Gabungan -->
        <div id="tempat_penyimpanan_display" class="bg-gray-50 border border-gray-200 rounded px-3 py-2">
          <p class="text-sm text-gray-600">Lokasi: <span id="lokasi_display" class="font-medium text-gray-800">-</span>
          </p>
        </div>
        <input type="hidden" id="tempat_penyimpanan" name="tempat_penyimpanan" value="" />

        <!-- Baris 9: Deskripsi -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Deskripsi</label>
          <textarea id="deskripsi" name="ket" placeholder="Catatan dan deskripsi tambahan tentang koleksi..."
            class="border border-gray-300 rounded px-3 py-2 w-full h-24 focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"></textarea>
        </div>

        <!-- Baris 10: Gambar -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Gambar/Foto</label>
          <input type="file" id="foto" name="foto" accept="image/*"
            class="border border-gray-300 rounded px-3 py-2 w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
        </div>

        <div id="imagePreview" class="hidden mt-2">
          <p class="text-sm text-gray-600 mb-2">Preview:</p>
          <img id="preview" class="h-48 w-48 object-cover rounded-lg border">
        </div>

        <div class="flex justify-end space-x-2 mt-6 pt-4 border-t">
          <button type="button" id="closeAddModal"
            class="px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400">Batal</button>
          <button id="btnSimpanKoleksi" type="submit"
            class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">Simpan</button>
        </div>

      </form>
    </div>
  </div>

  <!-- ================= MODAL DETAIL ================= -->
  <div id="detailModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white w-full max-w-3xl rounded-xl shadow-lg p-6 relative">
      <button id="closeDetailModal" class="absolute top-3 right-3 text-gray-400 hover:text-red-500">✕</button>
      <h2 class="text-xl font-semibold mb-4">Detail Koleksi</h2>
      <div id="modalContent" class="grid grid-cols-2 gap-4 text-sm">
        <div><strong>Nama Koleksi:</strong> <span id="detail_nama_benda">-</span></div>
        <div><strong>Kategori:</strong> <span id="detail_kategori">-</span></div>
        <div><strong>No Registrasi:</strong> <span id="detail_no_reg">-</span></div>
        <div><strong>No Inventaris:</strong> <span id="detail_no_inv">-</span></div>
        <div><strong>Bahan:</strong> <span id="detail_bahan">-</span></div>
        <div><strong>Ukuran:</strong> <span id="detail_ukuran">-</span></div>
        <div><strong>Kondisi:</strong> <span id="detail_kondisi">-</span></div>
        <div><strong>Tanggal Perolehan:</strong> <span id="detail_tanggal_perolehan">-</span></div>
        <div><strong>Asal Koleksi:</strong> <span id="detail_asal_koleksi">-</span></div>
        <div><strong>Tempat Penyimpanan:</strong> <span id="detail_tempat_penyimpanan">-</span></div>
        <div class="col-span-2"><strong>Deskripsi:</strong> <span id="detail_deskripsi">-</span></div>
        <div class="col-span-2"><strong>Gambar:</strong><br><img id="detail_gambar" class="mt-2 max-h-48 rounded" style="display: none;"><span id="no_image">Tidak ada gambar</span></div>
      </div>
    </div>
  </div>

  <!-- SCRIPT MODAL -->
  <script>
   document.addEventListener("DOMContentLoaded", () => {
  const btnTambah = document.getElementById("openModal");
  const modal = document.getElementById("modal");
  const btnClose = document.getElementById("closeAddModal");

  if (!btnTambah || !modal) {
    console.error("❌ Tombol atau modal tidak ditemukan");
    return;
  }

  // buka modal
  btnTambah.addEventListener("click", () => {
    modal.classList.remove("hidden");
  });

  // tutup modal
  btnClose?.addEventListener("click", () => {
    modal.classList.add("hidden");
  });

  // klik area hitam
  modal.addEventListener("click", (e) => {
    if (e.target === modal) {
      modal.classList.add("hidden");
    }
  });

  // Modal Detail
  const detailModal = document.getElementById("detailModal");
  const closeDetailModal = document.getElementById("closeDetailModal");

  closeDetailModal?.addEventListener("click", () => {
    detailModal.classList.add("hidden");
  });

  detailModal.addEventListener("click", (e) => {
    if (e.target === detailModal) {
      detailModal.classList.add("hidden");
    }
  });
});
  </script>

  <!-- External JS Modules -->
  <script type="module" src="../../Js/config/url_koleksi.js"></script>
  <script type="module" src="../../Js/controller/add-collection.js"></script>
  <script type="module" src="../../Js/Temp/tabel_koleksi_updated.js"></script>
  <script type="module" src="../../Js/controller/logout.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</body>

</html>